
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="./styles/navbar.css">
</head>

<body>
    <div id="nav_container"></div>


    <!-- <input id="input"> -->
        



    <div id="output"></div>
</body>
</html>

<script >
   

async function getbooks() {

  let x = Math.random() * 9;
  // console.log(x);
  x =Math.floor(x);
  let query=document.getElementById("input").value
  // console.log(query)
  if(!query){
      value=`Harry${x}`
  }else{
      value=query
  }

  let res = await fetch(`https://openlibrary.org/search.json?title=${value}`);


  try {
    let data = await res.json();
    // console.log("csdcjscj ")
    // console.log(data);
    append(data.docs);
  } catch (err) {
    console.log(err);
  }
}

function append(data) {
  document.getElementById("output").innerHTML = null;
  // console.log(data);
  let i = 0;
  data.map(function (el) {
// console.log(i++)
    let div = document.createElement("div");
    let img = document.createElement("img");
     if(el.isbn==null){
      img.src='https://covers.openlibrary.org/b/isbn/9780297858065-L.jpg'
     }else{
      img.src = `https://covers.openlibrary.org/b/isbn/${el.isbn[0]}-L.jpg`;

     }


    let p1 = document.createElement("p");
    p1.innerText = el.title;

    let p3 = document.createElement("p");
    let x = Math.random() * (1500 - 500) + 500;
    p3.innerText = `Price -${Math.floor(x)}`;
    let p4 = document.createElement("p");
    p4.innerText = el.author_name;
    
    let btn1 = document.createElement("button");
    btn1.setAttribute("id","btn1")
    let btn2 = document.createElement("button");
    btn2.setAttribute("id","btn2")
    btn1.innerText = "View Now";
    btn2.innerText = "More details";
    btn1.addEventListener("click", function () {
      detailsAtNewPage(el);
    });

    btn2.addEventListener("click", function () {
      detailsAtNewPage(el);
    });
     
    div.append(img, p1, p4, p3, btn1, btn2);

    img.addEventListener("click", function () {
      detailsAtNewPage(el);
    });
    document.getElementById("output").append(div);
  });
}

function detailsAtNewPage(data) {
  localStorage.setItem("bookData", JSON.stringify(data));
  window.location.href = "bookdata.html";
}

</script>

<!-- ******************************importing Navbar Section -->
<script type="module">
    import navbar from './components/navbar.js'
let navbar_append=document.getElementById("nav_container")
navbar_append.innerHTML=navbar()
getbooks();
</script>





